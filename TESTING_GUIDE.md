# MSHD 2.0 系统测试指南

## 📋 系统运行状态

### ✅ 已启动的服务

**后端服务:**
- 地址: http://localhost:8080/api
- 状态: ✅ 运行中
- 框架: Spring Boot 3.2.0
- 数据库: MySQL (mshd) + MongoDB (mshd_media)

**前端服务:**
- 地址: http://localhost:3000
- 状态: ✅ 运行中
- 框架: Vue 3 + Element Plus + ECharts

**测试账号:**
- 用户名: `admin`
- 密码: `admin123`
- 角色: 系统管理员

---

## 🧪 功能测试步骤

### 1. 登录功能测试

**步骤:**
1. 打开浏览器，访问 http://localhost:3000
2. 系统会自动跳转到登录页
3. 输入用户名: `admin`
4. 输入密码: `admin123`
5. (可选) 勾选"记住密码"
6. 点击"登录"按钮

**预期结果:**
- ✅ 登录成功后跳转到数据概览页面
- ✅ 右上角显示用户名 "Admin"
- ✅ 侧边栏显示完整菜单

**测试截图建议:**
- 登录页面
- 登录成功后的首页

---

### 2. 数据概览页面测试

**测试内容:**
- 查看4个统计卡片（目前数据为空是正常的）
- 查看数据来源分布饼图
- 查看灾害类别分布柱状图
- 查看7日数据趋势折线图
- 查看最新数据表格（目前为空）

**预期结果:**
- ✅ 所有图表正常显示
- ✅ 统计卡片显示数值（初始为0）
- ✅ 页面布局美观，无错位

---

### 3. 灾情数据新增功能测试

**步骤:**
1. 点击左侧菜单 "灾情数据"
2. 点击右上角 "新增数据" 按钮
3. 填写表单:
   - **基本信息:**
     - 数据来源: 选择 "后方指挥部"
     - 载体类型: 选择 "文字"
     - 灾害类别: 选择 "震情"

   - **地理信息:**
     - 经度: 101.123456
     - 纬度: 37.654321
     - 地震时间: 选择任意时间
     - 位置: 北京市海淀区

   - **详细描述:**
     - 描述: "测试地震数据，震级5.2级"
     - 备注: "系统测试数据"

4. 观察 **36位编码预览** 区域
5. 点击"提交"按钮

**预期结果:**
- ✅ 36位编码自动生成并显示
- ✅ 提交成功后显示成功提示
- ✅ 表格中新增一条数据
- ✅ 数据概览页面统计数据更新

**重要:** 记录生成的36位编码，后续编码工具测试会用到！

---

### 4. 灾情数据编辑功能测试

**步骤:**
1. 在灾情数据列表中，找到刚才新增的数据
2. 点击该行右侧的 "编辑" 按钮
3. 修改描述信息
4. 点击"更新"按钮

**预期结果:**
- ✅ 对话框显示原有数据
- ✅ 36位编码不可修改（只读）
- ✅ 更新成功后表格数据刷新

---

### 5. 数据源管理测试

**步骤:**
1. 点击左侧菜单 "数据源管理"
2. 点击 "新增数据源" 按钮
3. 填写表单:
   - 数据源名称: 测试数据源1
   - 数据源编码: 101
   - 数据源类型: 业务报送
   - 接口协议: HTTP
   - 数据源URL: http://localhost:8080/api/test
   - 认证方式: 无认证
   - 数据格式: JSON
   - 轮询间隔: 60
   - 是否启用: 开启
4. 点击"确定"

**预期结果:**
- ✅ 新增成功
- ✅ 统计卡片数据更新
- ✅ 列表中显示新数据源
- ✅ 状态开关可以切换

**额外测试:**
- 点击 "测试" 按钮（会失败，因为URL不存在，这是正常的）
- 点击状态开关，测试启用/禁用功能

---

### 6. 数据编码工具测试

**测试项目:**

#### 6.1 编码生成器
**步骤:**
1. 点击左侧菜单 "数据编码"
2. 默认在 "编码生成器" Tab
3. 填写以下信息:
   - 经度: 101.12
   - 纬度: 37.65
   - 地震时间: 2021-05-22 02:04:00
   - 数据来源: 后方指挥部
   - 载体类型: 文字
   - 灾害类别: 人员伤亡

**预期结果:**
- ✅ 编码结构区域实时更新（颜色分块显示）
- ✅ 完整编码显示: `10112003765020210522020400101030200`
- ✅ 编码信息描述表正确显示
- ✅ 点击"复制"按钮可复制编码

#### 6.2 编码解析器
**步骤:**
1. 切换到 "编码解析器" Tab
2. 输入刚才生成的36位编码
3. 或使用示例: `632626200206202105220204001010302001`

**预期结果:**
- ✅ 自动解析出各部分编码
- ✅ 显示解析后的信息（经纬度、时间、来源、载体、灾情）
- ✅ 颜色分块显示

#### 6.3 编码规则
**步骤:**
1. 切换到 "编码规则" Tab
2. 展开各个折叠面板

**预期结果:**
- ✅ 显示完整的编码规范文档
- ✅ 包含对照表（来源码、载体码、灾情码）
- ✅ 显示完整示例

---

### 7. 统计分析测试

**前提:** 需要先添加至少3-5条测试数据

**步骤:**
1. 点击左侧菜单 "统计分析"
2. 测试筛选功能:
   - 选择时间范围
   - 选择灾害类别
   - 选择数据来源
   - 点击"查询"按钮
3. 点击"重置"按钮
4. 点击"导出报表"按钮

**预期结果:**
- ✅ 4个统计卡片显示正确数据
- ✅ 灾害类别分布环形图正确渲染
- ✅ 数据来源分布柱状图正确渲染
- ✅ 数据接入趋势折线图正确渲染
- ✅ 详细统计表格显示数据
- ✅ CSV文件成功下载

---

### 8. 数据大屏测试

**步骤:**
1. 点击左侧菜单 "数据大屏"
2. 观察页面布局（三列布局）
3. 点击右上角全屏按钮
4. 等待30秒观察自动刷新

**预期结果:**
- ✅ 深色主题显示
- ✅ 实时时钟正常运行
- ✅ 左侧：统计卡片 + 类别玫瑰图 + 来源雷达图
- ✅ 中间：地理分布地图 + 时间趋势图
- ✅ 右侧：载体环形图 + 实时数据流 + 数据源状态
- ✅ 全屏功能正常
- ✅ 30秒后数据自动刷新
- ✅ 所有图表响应式调整

---

### 9. 数据可视化测试

**步骤:**
1. 点击左侧菜单 "数据可视化"
2. 测试4种视图切换:

#### 9.1 概览视图
**预期结果:**
- ✅ 灾害类别占比饼图
- ✅ 数据来源分布饼图
- ✅ 数据量趋势折线图
- ✅ 载体类型分布柱状图
- ✅ 数据完整度分析饼图

#### 9.2 类别分析
**预期结果:**
- ✅ 各类别数据量对比横向柱状图
- ✅ 类别统计详情（进度条样式）
- ✅ 类别时间分布热力图

#### 9.3 地域分布
**预期结果:**
- ✅ 地理分布散点地图
- ✅ 地区数据排名（TOP 10）
- ✅ 地区数据密度柱状图

#### 9.4 时间轴
**步骤:**
- 切换时间粒度（按小时/天/周/月）
- 观察图表变化

**预期结果:**
- ✅ 时间轴趋势图根据粒度变化
- ✅ 时段分布柱状图（24小时）
- ✅ 星期分布饼图

---

### 10. 退出登录测试

**步骤:**
1. 点击右上角用户名
2. 点击下拉菜单中的 "退出登录"
3. 确认退出

**预期结果:**
- ✅ 显示确认对话框
- ✅ 确认后跳转到登录页
- ✅ 无法直接访问系统页面（会被重定向到登录页）

---

## 🎯 完整测试流程建议

### 测试场景1: 完整业务流程
1. 登录系统 → 2. 查看数据概览（空数据） → 3. 添加5条测试数据 → 4. 返回数据概览（查看统计更新） → 5. 进入统计分析查看图表 → 6. 进入数据大屏观看 → 7. 测试编码工具 → 8. 退出登录

### 测试场景2: 数据可视化重点测试
1. 登录 → 2. 批量添加10条不同类别、不同地区的数据 → 3. 进入数据可视化 → 4. 切换4种视图 → 5. 测试筛选功能 → 6. 观察图表变化

### 测试场景3: 数据源管理流程
1. 登录 → 2. 进入数据源管理 → 3. 添加3个不同类型的数据源 → 4. 测试启用/禁用 → 5. 编辑数据源 → 6. 测试连接 → 7. 删除数据源

---

## 🐛 已知限制和注意事项

1. **MongoDB连接:**
   - 如果MongoDB未启动，系统仍可运行（媒体功能会受限）
   - 建议: 启动MongoDB以获得完整功能

2. **地图显示:**
   - 地图需要中国地图数据
   - 如果地图不显示，需要导入ECharts中国地图JSON

3. **初始数据:**
   - 系统初始无数据，所有图表为空是正常的
   - 建议添加至少5-10条测试数据以观看可视化效果

4. **编码验证:**
   - 36位编码格式严格，修改时注意保持格式
   - 编码一旦生成不建议手动修改

---

## 📊 推荐测试数据

### 测试数据1:
- 经度: 116.4074, 纬度: 39.9042, 位置: 北京市, 类别: 震情
- 经度: 121.4737, 纬度: 31.2304, 位置: 上海市, 类别: 人员伤亡
- 经度: 113.2644, 纬度: 23.1291, 位置: 广州市, 类别: 房屋破坏
- 经度: 104.0665, 纬度: 30.5723, 位置: 成都市, 类别: 生命线工程
- 经度: 120.1551, 纬度: 30.2741, 位置: 杭州市, 类别: 次生灾害

### 测试数据2（不同来源）:
- 后方指挥部 + 文字
- 现场指挥部 + 图像
- 业务报送 + 音频
- 泛在感知 + 视频
- 舆情感知 + 文字

---

## ✅ 测试完成标准

完成以下所有项即可视为系统测试通过:

- [ ] 登录/退出功能正常
- [ ] 数据概览页面正常显示
- [ ] 成功新增至少5条灾情数据
- [ ] 成功编辑数据
- [ ] 成功新增至少2个数据源
- [ ] 编码生成器工作正常
- [ ] 编码解析器工作正常
- [ ] 统计分析所有图表正常显示
- [ ] 数据大屏正常显示且自动刷新
- [ ] 数据可视化4种视图均正常
- [ ] CSV报表成功导出

---

## 🔧 故障排查

### 问题1: 前端无法访问
**解决方案:**
```bash
# 检查前端进程
netstat -ano | findstr :3000

# 重启前端
cd D:\Bupt\2025Autumn\SET\Project\mshd-frontend
npm run dev
```

### 问题2: 后端API报错
**解决方案:**
```bash
# 检查MySQL
mysql -uroot -pSujinghui2004@ -e "SHOW DATABASES;"

# 检查后端日志
cd D:\Bupt\2025Autumn\SET\Project\mshd-backend
# 查看控制台输出
```

### 问题3: 登录失败
**解决方案:**
```bash
# 检查用户是否存在
mysql -uroot -pSujinghui2004@ mshd -e "SELECT * FROM sys_user WHERE username='admin';"

# 重新插入用户
mysql -uroot -pSujinghui2004@ mshd -e "INSERT INTO sys_user (username, password, real_name, role, status) VALUES ('admin', '\$2a\$10\$N.zmdr9k7uOCQb376NoUnuTJ8iAt6Z5EHsM8lE9lBOsl7iAt6Z5EH', 'Admin', 'admin', 1);"
```

### 问题4: 图表不显示
**解决方案:**
1. 检查浏览器控制台是否有错误
2. 确保添加了测试数据
3. 刷新页面
4. 清除浏览器缓存

---

## 📞 技术支持

如遇到其他问题:
1. 查看浏览器控制台 (F12)
2. 查看后端控制台日志
3. 检查网络请求 (F12 → Network)
4. 验证数据库数据

---

**开始测试吧! 🚀**

访问: http://localhost:3000
用户名: admin
密码: admin123
